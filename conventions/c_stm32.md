# C Code (STM32 Target) Conventions

---

<details markdown="1">
  <summary>Table of Contents</summary>

- [1 Background](#1-background)
- [2 Language Rules](#2-language-rules)
    - [2.1 Lint](#21-lint)
        - [2.1.1 Pros](#211-pros)
        - [2.1.2 Cons](#212-cons)
- [3 Style Rules](#3-style-rules)
    - [3.1 Line Length](#31-line-length)
        - [3.1.1 Exceptions](#311-exceptions)
        - [3.1.2 Pros](#312-pros)
        - [3.1.3 Cons](#313-cons)
    - [3.3 File Structure](#33-file-structure)
        - [3.3.1 Pros](#331-pros)
        - [3.3.2 Cons](#332-cons)
    - [3.4 Directory Names](#34-directory-names)
    - [3.5 Module Names](#35-module-names)
    - [3.6 Variable Names](#36-variable-names)

</details>

---

## 1 Background

Writing code for STM32 targets can be difficult and time-consuming. The
following conventions are designed to work with common development environments
and toolchains:

- [stm32_clion_setup.md](../devenvs/stm32_clion_setup.md).
- [stm32_cubeide_setup.md](../devenvs/stm32_cubeide_setup.md).

---

## 2 Language Rules

### 2.1 Lint

Use [Clang-Tidy](https://clang.llvm.org/extra/clang-tidy/).

#### 2.1.1 Pros

Built into most IDEs including JetBrains. Good simple error catching, typos,
etc.

#### 2.1.2 Cons

Imperfect and slight variations.

---

## 3 Style Rules

### 3.1 Line Length

Max line length = `80`.

#### 3.1.1 Exceptions

Exceptions to the limit are:

- URLs, filepaths, etc.
- Long constants not containing whitespace that would be inconvenient to split.

#### 3.1.2 Pros

Matches most code generation tools, fits A4 print papers and typical maximum in
industry.

#### 3.1.3 Cons

None, mostly subjective.

### 3.3 File Structure

Use the file structure generated by code generation tools targeted for ST's
official STM32CubeIDE Toolchain. Always write within the "user code" sections
specified by the comments in generated code.

- `Toolchain / IDE` = `STM32CubeIDE` setting takes supremacy at all times unless
  specifically stated.

#### 3.3.1 Pros

Ensures CubeMX compatability, allowing for convent initialization, HAL setup and
code generation. Also is the official supported format.

#### 3.3.2 Cons

Can be restrictive in certain scenarios when dependent on HAL.

### 3.4 Directory Names

Use a single word, all lowercase characters.

### 3.5 Module Names

Use snake_case.

### 3.6 Variable Names

Use snake_case.
